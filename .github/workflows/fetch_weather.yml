name: Fetch weather seoul Date #서울 날씨 정보 수집

on: # 작업 수행 조건
  schedule:
   - cron: "*/1 * * * *" # 옵션
  workflow_dispatch: # 수동으로 동작
  push:  # 언제 동작시킬 것인지
    branches:
      - main # main에 push가 일어나면
jobs: # 실행할 작업 정의
  fetch_weather: # 작업이름
    runs-on: ubuntu-lastes # linux os ubuntu 최신 버전

    steps: #실행 동작 단계
      - name: 저장소 체크아웃
        uses: actions/checkout@v3 # 현재 github 저장소를 clone
        with: # 옵션
          token: ${{secrets.GITHUB_TOKEN}} # 자신의 GITHUB 권한 사용

      - name: Python 설정
        uses: actions/setup-python@v4 # python 설치 플러그인 동작
        with: 
          python-version: "3.9"
          
      - name: 필요한 패키지 설치
        run: pip install requests # API 요청 위한 Library 설치

      - name: 날씨 데이터 가져오기
        env: # GITHUN secrets 에서 환경 변수 가져오기
          OPENWEATHER_API_KEY: ${{secrets.OPENWEATHER_API_KEY}}
        run: python weather_script.py

      - name: 변경 사항 확인 및 푸시
        run: | 
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions@github.com"
          git add seoul_weather.csv # 날씨 데이터 저장 csv를 github에 추가
          git commit "Update weather data (auto)" # 변경사항 존재시 commit
          git push # 변경 사항 git에 push 
          
